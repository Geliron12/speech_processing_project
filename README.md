# Обработка речи. Телеграм чат-бот для перевода

## Функционал чат-бота

id-чат бота - @translate_from_russian_bot. Данный чат бот использует технологии TTS и STT для перевода русскоязычного текста на иностранные языки. В данный момент реализовано 3 языка - английский, немецкий, испанский. Стартовое меню вызывается по команде /start, смена языка по команде /change_language. Бот может принимать голосовые и текстовые сообщения. Голосовое сообщение переводится в текст, далее отправляется на перевод, выводится перевод и приходит голосовое сообщение с озвучкой переведенного текста. Голосовые сообщения сначала сохраняются в формате ogg, потом переводятся в wav. Для запуска чат-бота необходим его токен в .env(Сюда его выгружать не стал), далее необходимо запустить файл run.py

## Использованные модели

# Text-To-Speech

В качестве text-to-speech модели была взята opensource модель silero-tts. Для трансформации используются модели версии v3, все три модели подгружаются в специальный файл, если не подгружены. Для каждого языка исходная модель имеет несколько различных голосов. Модель транслирует текст в wav формат, частота дискретизации - 48 килогерц, такая же частота дискретизации у голосовых сообщений в телеграме по умолчанию, но ее можно уменьшить чтобы ускорить инференс модели(поддерживается 8 и 24 килогерц). Специальный класс для работы с silero-tts лежит в директории tg_bot/tts

# Speech-To-Text

Text-to-speech моделью в данном проекте выбрана opensource модель Vosk. Маленькая русскоязычная модель весит 45 Мб. Имеет отдельную библиотеку vosk в pypi. Частота дискретизации выбрана 48 килогерц, такая частота необходима для обработки голосовых сообщений из телеграма. Специальный класс для работы с моделью vosk лежит в директории tg_bots/stt

# Translation
В качестве модели для перевода была выбрана opensource модель facebook/nllb-200-distilled-600M с huggingface. Seq-to-seq модель машинного перевода, поддерживает 200 языков, в зависимости от языка разная токенизация. Одна из наиболее качественных открытых небольших моделей для задачи перевода. Все модели инференcились на одной видеокарте с памятью в 4GB(Чего иногда могло не хватать).
